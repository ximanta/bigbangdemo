import {useState} from 'react';import {Link} from 'react-router-dom';import {useAuth} from '../context/AuthContext';import {Search, Filter} from 'lucide-react';import {getStatusTagClass, getPriorityTagClass} from '../utils/helpers';const TicketTable = ({tickets, showCustomerColumn = true}) => {const {getUserById} = useAuth();const [searchTerm, setSearchTerm] = useState('');const [statusFilter, setStatusFilter] = useState('All');const [priorityFilter, setPriorityFilter] = useState('All');const [assigneeFilter, setAssigneeFilter] = useState('All');const [currentPage, setCurrentPage] = useState(1);const ticketsPerPage = 10;const allAssignees = [...new Set(tickets.map(t => t.assigneeId).filter(Boolean))].map(id => getUserById(id));const filteredTickets = tickets.filter(ticket => {const customer = getUserById(ticket.customerId);const assignee = getUserById(ticket.assigneeId);const matchesSearch = ticket.subject.toLowerCase().includes(searchTerm.toLowerCase()) ||ticket.description.toLowerCase().includes(searchTerm.toLowerCase()) ||(customer && customer.name.toLowerCase().includes(searchTerm.toLowerCase())) ||(assignee && assignee.name.toLowerCase().includes(searchTerm.toLowerCase()));const matchesStatus = statusFilter === 'All' || ticket.status === statusFilter;const matchesPriority = priorityFilter === 'All' || ticket.priority === priorityFilter;const matchesAssignee = assigneeFilter === 'All' || ticket.assigneeId === assigneeFilter;return matchesSearch && matchesStatus && matchesPriority && matchesAssignee;});const indexOfLastTicket = currentPage * ticketsPerPage;const indexOfFirstTicket = indexOfLastTicket - ticketsPerPage;const currentTickets = filteredTickets.slice(indexOfFirstTicket, indexOfLastTicket);const totalPages = Math.ceil(filteredTickets.length / ticketsPerPage);const paginate = (pageNumber) => setCurrentPage(pageNumber);return (<div className="ticket-table-container"><div className="filter-bar"><div className="search-bar"><inputtype="text"placeholder="Search tickets..."className="input-field"value={searchTerm}onChange={(e) => setSearchTerm(e.target.value)}/><Search size={18} style={{position: 'relative', left: '-30px', color: '#888'}}/></div><div className="filter-group"><label htmlFor="status-filter" className="hidden">Status:</label><selectid="status-filter"className="select-field"value={statusFilter}onChange={(e) => setStatusFilter(e.target.value)}><option value="All">All Statuses</option><option value="Open">Open</option><option value="InProgress">In Progress</option><option value="Resolved">Resolved</option><option value="Closed">Closed</option></select></div><div className="filter-group"><label htmlFor="priority-filter" className="hidden">Priority:</label><selectid="priority-filter"className="select-field"value={priorityFilter}onChange={(e) => setPriorityFilter(e.target.value)}><option value="All">All Priorities</option><option value="Low">Low</option><option value="Medium">Medium</option><option value="High">High</option></select></div><div className="filter-group"><label htmlFor="assignee-filter" className="hidden">Assignee:</label>{showCustomerColumn && (<selectid="assignee-filter"className="select-field"value={assigneeFilter}onChange={(e) => setAssigneeFilter(e.target.value)}><option value="All">All Assignees</option>{allAssignees.map(user => (<option key={user.id} value={user.id}>{user.name}</option>))}</select>)}</div><div className="filter-group"><label htmlFor="date-range" className="hidden">Date Range:</label><inputtype="text"id="date-range"className="input-field"placeholder="Date Range (Not implemented)"disabled/></div></div><div className="table-container"><table className="data-table"><thead><tr><th>Ticket ID</th><th>Subject</th>{showCustomerColumn && <th>Customer</th>}<th>Status</th><th>Priority</th><th>Assignee</th><th>Last Update</th></tr></thead><tbody>{currentTickets.length > 0 ? (currentTickets.map((ticket) => {const customer = getUserById(ticket.customerId);const assignee = getUserById(ticket.assigneeId);return (<tr key={ticket.id}><td><Link to={`/tickets/${ticket.id}`}>{ticket.id}</Link></td><td>{ticket.subject}</td>{showCustomerColumn && <td>{customer ? customer.name : 'N/A'}</td>}<td><span className={`ticket-status-tag ${getStatusTagClass(ticket.status)}`}>{ticket.status}</span></td><td><span className={`ticket-priority-tag ${getPriorityTagClass(ticket.priority)}`}>{ticket.priority}</span></td><td>{assignee ? assignee.name : 'Unassigned'}</td><td>{ticket.updatedAt}</td></tr>);})) : (<tr><td colSpan={showCustomerColumn ? 7 : 6} className="text-center">No tickets found.</td></tr>)}</tbody></table></div><div className="pagination"><buttononClick={() => paginate(currentPage - 1)}disabled={currentPage === 1}className="btn btn-secondary btn-inline">Previous</button><span className="pagination-info">Page {currentPage} of {totalPages}</span><buttononClick={() => paginate(currentPage + 1)}disabled={currentPage === totalPages}className="btn btn-secondary btn-inline">Next</button></div></div>);};export default TicketTable;