import React, { useState } from 'react';import { Search, Tag, Eye, Check, X, Trash2 } from 'lucide-react';import Card from '../../components/Card';import Button from '../../components/Button';import InputField from '../../components/InputField';import SelectField from '../../components/SelectField';import Modal from '../../components/Modal';import Table from '../../components/Table';import Notification from '../../components/Notification';import Checkbox from '../../components/Checkbox';import { mockArticles, mockSources, mockTopics } from '../../data/mockData';import { formatDateTime } from '../../utils/helpers';const ArticleManagement = () => {  const [articles, setArticles] = useState(mockArticles);  const [searchTerm, setSearchTerm] = useState('');  const [filterSource, setFilterSource] = useState('');  const [filterStatus, setFilterStatus] = useState('');  const [selectedArticles, setSelectedArticles] = useState([]);  const [isArticlePreviewModalOpen, setIsArticlePreviewModalOpen] = useState(false);  const [previewArticle, setPreviewArticle] = useState(null);  const [isTaggingModalOpen, setIsTaggingModalOpen] = useState(false);  const [currentTaggingArticleIds, setCurrentTaggingArticleIds] = useState([]);  const [newTag, setNewTag] = useState('');  const [notification, setNotification] = useState(null);  const filteredArticles = articles.filter(article => {    const matchesSearch = article.title.toLowerCase().includes(searchTerm.toLowerCase());    const matchesSource = filterSource ? article.sourceId === filterSource : true;    const matchesStatus = filterStatus ? article.status === filterStatus : true;    return matchesSearch && matchesSource && matchesStatus;  });  const handleSelectAll = (e) => {    if (e.target.checked) {      setSelectedArticles(filteredArticles.map(article => article.id));    } else {      setSelectedArticles([]);    }  };  const handleSelectArticle = (id) => {    setSelectedArticles(prev =>      prev.includes(id) ? prev.filter(articleId => articleId !== id) : [...prev, id]    );  };  const handleApprove = () => {    setArticles(prev =>      prev.map(article =>        selectedArticles.includes(article.id) ? { ...article, status: 'Approved' } : article      )    );    setSelectedArticles([]);    setNotification({ message: `${selectedArticles.length} article(s) approved.`, type: 'success' });  };  const handleReject = () => {    setArticles(prev =>      prev.map(article =>        selectedArticles.includes(article.id) ? { ...article, status: 'Rejected' } : article      )    );    setSelectedArticles([]);    setNotification({ message: `${selectedArticles.length} article(s) rejected.`, type: 'success' });  };  const handleDelete = () => {    if (window.confirm('Are you sure you want to delete the selected articles?')) {      setArticles(prev => prev.filter(article => !selectedArticles.includes(article.id)));      setSelectedArticles([]);      setNotification({ message: `${selectedArticles.length} article(s) deleted.`, type: 'success' });    }  };  const openArticlePreview = (article) => {    setPreviewArticle(article);    setIsArticlePreviewModalOpen(true);  };  const closeArticlePreview = () => {    setIsArticlePreviewModalOpen(false);    setPreviewArticle(null);  };  const openTaggingModal = (articleIds) => {    setCurrentTaggingArticleIds(articleIds);    setIsTaggingModalOpen(true);  };  const closeTaggingModal = () => {    setIsTaggingModalOpen(false);    setNewTag('');    setCurrentTaggingArticleIds([]);  };  const handleAddTag = () => {    if (newTag.trim() === '') return;    setArticles(prev =>      prev.map(article =>        currentTaggingArticleIds.includes(article.id)          ? { ...article, tags: [...new Set([...article.tags, newTag.trim()])] }          : article      )    );    setNotification({ message: `Tag '${newTag}' added.`, type: 'success' });    closeTaggingModal();  };  const handleRemoveTag = (articleId, tagToRemove) => {    setArticles(prev =>      prev.map(article =>        article.id === articleId          ? { ...article, tags: article.tags.filter(tag => tag !== tagToRemove) }          : article      )    );    setNotification({ message: `Tag '${tagToRemove}' removed.`, type: 'success' });  };  const headers = [' ', 'Title', 'Source', 'Date', 'Status', 'Tags', 'Actions'];  const renderArticleRow = (article) => (    <>      <td>        <Checkbox          id={`select-${article.id}`}          checked={selectedArticles.includes(article.id)}          onChange={() => handleSelectArticle(article.id)}        />      </td>      <td>{article.title}</td>      <td>{article.sourceName}</td>      <td>{formatDateTime(article.date)}</td>      <td>        <span          className={`badge ${            article.status === 'Approved' ? 'badge-success' :            article.status === 'Pending' ? 'badge-warning' :            'badge-danger'          }`}        >          {article.status}        </span>      </td>      <td>        <div className="flex-container flex-wrap gap-2">          {article.tags.map(tag => (            <span key={tag} className="tag-item">              {tag}              <button onClick={() => handleRemoveTag(article.id, tag)}>                <X size={12} />              </button>            </span>          ))}          <Button            variant="link"            onClick={() => openTaggingModal([article.id])}            title="Add Tags"          >            <Tag size={16} />          </Button>        </div>      </td>      <td className="action-buttons">        <Button variant="secondary" onClick={() => openArticlePreview(article)} title="Preview Article">          <Eye size={16} />        </Button>        <Button variant="secondary" onClick={() => handleApprove([article.id])} title="Approve Article">          <Check size={16} />        </Button>        <Button variant="danger" onClick={() => handleDelete([article.id])} title="Delete Article">          <Trash2 size={16} />        </Button>      </td>    </>  );  return (    <div>      <Card title="Article Management">        <div className="flex-container justify-between mb-4 gap-4 flex-wrap">          <InputField            id="search"            placeholder="Search by title..."            value={searchTerm}            onChange={(e) => setSearchTerm(e.target.value)}            className="flex-grow"          />          <SelectField            id="filterSource"            value={filterSource}            onChange={(e) => setFilterSource(e.target.value)}            options={[              { value: '', label: 'All Sources' },              ...mockSources.map(s => ({ value: s.id, label: s.name }))            ]}            className="min-w-[150px]"          />          <SelectField            id="filterStatus"            value={filterStatus}            onChange={(e) => setFilterStatus(e.target.value)}            options={[              { value: '', label: 'All Statuses' },              { value: 'Approved', label: 'Approved' },              { value: 'Pending', label: 'Pending' },              { value: 'Rejected', label: 'Rejected' }            ]}            className="min-w-[150px]"          />        </div>        <div className="flex-container gap-2 mb-4">          <Button            variant="primary"            onClick={handleApprove}            disabled={selectedArticles.length === 0}          >            <Check size={18} className="mr-2" /> Approve Selected ({selectedArticles.length})          </Button>          <Button            variant="secondary"            onClick={handleReject}            disabled={selectedArticles.length === 0}          >            <X size={18} className="mr-2" /> Reject Selected ({selectedArticles.length})          </Button>          <Button            variant="secondary"            onClick={() => openTaggingModal(selectedArticles)}            disabled={selectedArticles.length === 0}          >            <Tag size={18} className="mr-2" /> Tag Selected ({selectedArticles.length})          </Button>          <Button            variant="danger"            onClick={handleDelete}            disabled={selectedArticles.length === 0}          >            <Trash2 size={18} className="mr-2" /> Delete Selected ({selectedArticles.length})          </Button>        </div>        <Table          headers={headers}          data={filteredArticles}          renderRow={renderArticleRow}          keyExtractor={(item) => item.id}        />      </Card>      <Modal        isOpen={isArticlePreviewModalOpen}        onClose={closeArticlePreview}        title={previewArticle ? previewArticle.title : 'Article Preview'}        footerButtons={[          { label: 'Close', variant: 'secondary', onClick: closeArticlePreview }        ]}      >        {previewArticle && (          <div>            <p className="text-sm text-muted mb-2">              Source: {previewArticle.sourceName} | Published: {formatDateTime(previewArticle.date)}            </p>            <div className="flex-container flex-wrap gap-2 mb-4">              {previewArticle.tags.map(tag => (                <span key={tag} className="badge badge-info">{tag}</span>              ))}            </div>            {previewArticle.image && (              <img src={previewArticle.image} alt={previewArticle.title} className="w-full rounded mb-4" style={{ maxHeight: '250px', objectFit: 'cover' }} />            )}            <p className="text-lg leading-relaxed">{previewArticle.content}</p>          </div>        )}      </Modal>      <Modal        isOpen={isTaggingModalOpen}        onClose={closeTaggingModal}        title="Add Tags to Articles"        footerButtons={[          { label: 'Cancel', variant: 'secondary', onClick: closeTaggingModal },          { label: 'Add Tag', variant: 'primary', onClick: handleAddTag }        ]}      >        <InputField          label="New Tag"          id="newTag"          value={newTag}          onChange={(e) => setNewTag(e.target.value)}          placeholder="e.g., AI, Blockchain"          required        />        <p className="text-sm text-muted mt-2">          Applying tag to {currentTaggingArticleIds.length} selected article(s).        </p>      </Modal>      {notification && (        <Notification          message={notification.message}          type={notification.type}          onClose={() => setNotification(null)}        />      )}    </div>  );};export default ArticleManagement;