import React, { useState } from 'react';import { Plus, Edit, Trash2, Search, Mail } from 'lucide-react';import Card from '../../components/Card';import Button from '../../components/Button';import InputField from '../../components/InputField';import SelectField from '../../components/SelectField';import Checkbox from '../../components/Checkbox';import Modal from '../../components/Modal';import Table from '../../components/Table';import Notification from '../../components/Notification';import { mockSubscribers, mockTopics } from '../../data/mockData';import { generateUniqueId, formatDateTime } from '../../utils/helpers';const SubscriberManagement = () => {  const [subscribers, setSubscribers] = useState(mockSubscribers);  const [isModalOpen, setIsModalOpen] = useState(false);  const [editingSubscriber, setEditingSubscriber] = useState(null);  const [form, setForm] = useState({    email: '',    status: 'Active',    topics: []  });  const [searchTerm, setSearchTerm] = useState('');  const [filterStatus, setFilterStatus] = useState('');  const [notification, setNotification] = useState(null);  const handleInputChange = (e) => {    const { id, value } = e.target;    setForm(prev => ({ ...prev, [id]: value }));  };  const handleTopicChange = (topic) => {    setForm(prev => ({      ...prev,      topics: prev.topics.includes(topic)        ? prev.topics.filter(t => t !== topic)        : [...prev.topics, topic]    }));  };  const openAddModal = () => {    setEditingSubscriber(null);    setForm({ email: '', status: 'Active', topics: [] });    setIsModalOpen(true);  };  const openEditModal = (subscriber) => {    setEditingSubscriber(subscriber);    setForm({      email: subscriber.email,      status: subscriber.status,      topics: subscriber.topics    });    setIsModalOpen(true);  };  const closeModal = () => {    setIsModalOpen(false);    setEditingSubscriber(null);    setForm({ email: '', status: 'Active', topics: [] });  };  const handleSubmit = (e) => {    e.preventDefault();    if (editingSubscriber) {      setSubscribers(prev => prev.map(s => s.id === editingSubscriber.id ? { ...s, ...form } : s));      setNotification({ message: 'Subscriber updated successfully!', type: 'success' });    } else {      const newSubscriber = {        id: generateUniqueId(),        ...form,        lastActivity: new Date().toISOString()      };      setSubscribers(prev => [...prev, newSubscriber]);      setNotification({ message: 'Subscriber added successfully!', type: 'success' });    }    closeModal();  };  const handleDelete = (id) => {    if (window.confirm('Are you sure you want to delete this subscriber?')) {      setSubscribers(prev => prev.filter(s => s.id !== id));      setNotification({ message: 'Subscriber deleted successfully!', type: 'success' });    }  };  const filteredSubscribers = subscribers.filter(subscriber => {    const matchesSearch = subscriber.email.toLowerCase().includes(searchTerm.toLowerCase());    const matchesStatus = filterStatus ? subscriber.status === filterStatus : true;    return matchesSearch && matchesStatus;  });  const headers = ['Email', 'Status', 'Topics', 'Last Activity', 'Actions'];  const renderSubscriberRow = (subscriber) => (    <>      <td>{subscriber.email}</td>      <td>        <span          className={`badge ${            subscriber.status === 'Active' ? 'badge-success' : 'badge-danger'          }`}        >          {subscriber.status}        </span>      </td>      <td>        <div className="flex-container flex-wrap gap-1">          {subscriber.topics.map(topic => (            <span key={topic} className="badge badge-info text-sm">{topic}</span>          ))}          {subscriber.topics.length === 0 && <span className="text-muted text-sm">None</span>}        </div>      </td>      <td>{formatDateTime(subscriber.lastActivity)}</td>      <td className="action-buttons">        <Button variant="secondary" onClick={() => openEditModal(subscriber)} title="Edit Subscriber">          <Edit size={16} />        </Button>        <Button variant="danger" onClick={() => handleDelete(subscriber.id)} title="Delete Subscriber">          <Trash2 size={16} />        </Button>      </td>    </>  );  return (    <div>      <Card title="Subscriber Management">        <div className="flex-container justify-between mb-4 gap-4 flex-wrap">          <InputField            id="search"            placeholder="Search by email..."            value={searchTerm}            onChange={(e) => setSearchTerm(e.target.value)}            className="flex-grow"          />          <SelectField            id="filterStatus"            value={filterStatus}            onChange={(e) => setFilterStatus(e.target.value)}            options={[              { value: '', label: 'All Statuses' },              { value: 'Active', label: 'Active' },              { value: 'Inactive', label: 'Inactive' }            ]}            className="min-w-[150px]"          />          <Button variant="primary" onClick={openAddModal}>            <Plus size={18} className="mr-2" /> Add New Subscriber          </Button>          <Button variant="secondary" onClick={() => setNotification({ message: 'Export initiated!', type: 'info' })}>            <Mail size={18} className="mr-2" /> Export Subscribers          </Button>        </div>        <Table          headers={headers}          data={filteredSubscribers}          renderRow={renderSubscriberRow}          keyExtractor={(item) => item.id}        />      </Card>      <Modal        isOpen={isModalOpen}        onClose={closeModal}        title={editingSubscriber ? 'Edit Subscriber' : 'Add New Subscriber'}        footerButtons={[          { label: 'Cancel', variant: 'secondary', onClick: closeModal },          { label: editingSubscriber ? 'Save Changes' : 'Add Subscriber', variant: 'primary', onClick: handleSubmit, type: 'submit' }        ]}      >        <form onSubmit={handleSubmit}>          <InputField            label="Email"            id="email"            type="email"            value={form.email}            onChange={handleInputChange}            placeholder="subscriber@example.com"            required            readOnly={!!editingSubscriber} // Email should not be editable for existing subscribers          />          <SelectField            label="Subscription Status"            id="status"            value={form.status}            onChange={handleInputChange}            options={[              { value: 'Active', label: 'Active' },              { value: 'Inactive', label: 'Inactive' }            ]}            required          />          <div className="input-field-group">            <label>Topics of Interest</label>            <div className="flex-container flex-wrap gap-2">              {mockTopics.map(topic => (                <Checkbox                  key={topic}                  id={`topic-${topic}`}                  label={topic}                  checked={form.topics.includes(topic)}                  onChange={() => handleTopicChange(topic)}                />              ))}            </div>          </div>        </form>      </Modal>      {notification && (        <Notification          message={notification.message}          type={notification.type}          onClose={() => setNotification(null)}        />      )}    </div>  );};export default SubscriberManagement;